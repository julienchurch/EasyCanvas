function LightFX(t){this.canvas=document.createElement("canvas"),this.canvas.id="main",this.ctx=this.canvas.getContext("2d"),this.tempCanvas=void 0,this.imageData=void 0,this.cachedImageData=void 0,this.blurStack=void 0,this._init(t)}function lblur(t){for(var a=0;30>a;a++){var i=new LightFX;i.resizeTo(t),i.drawCover(t);var e=i.lightblur(40);document.body.appendChild(e)}}function sblur(t){for(var a=0;30>a;a++){var i=new LightFX;i.resizeTo(t),i.drawCover(t),i.blur("stackblur",40),document.body.appendChild(i.canvas)}}function binmoid(t){return 255/(1+Math.pow(Math.E,-t))}LightFX.prototype._init=function(t){void 0!==t&&(this._resizeTo(this.canvas,t),this.ctx.drawImage(t,0,0,this.canvas.width,this.canvas.height))},LightFX.prototype.createCanvas=function(t,a,i,e,h){var n,s,c;void 0!==i&&(n=i.data||i),s=document.createElement("canvas"),c=s.getContext("2d"),s.width=t,s.height=a,c.putImageData(i,e,h),this.canvas=s,this.ctx=c},LightFX.prototype._cloneCanvas=function(t){var a=this._createTempCanvas();return a.canvas.width=t.width,a.canvas.height=t.height,a.ctx.drawImage(t,0,0),a.canvas},LightFX.prototype.replaceCanvas=function(t){this.canvas=t,this.ctx=t.getContext("2d")},LightFX.prototype._createTempCanvas=function(){var t=document.createElement("canvas"),a=t.getContext("2d");return{canvas:t,ctx:a}},LightFX.prototype.resize=function(t,a){this.canvas.width=t,this.canvas.heght=a},LightFX.prototype._resizeTo=function(t,a){t.width=a.offsetWidth||a.naturalWidth||a.width,t.height=a.offsetHeight||a.naturalHeight||a.height},LightFX.prototype.resizeTo=function(t){this._resizeTo(this.canvas,t)},LightFX.prototype.styleAsBackground=function(t,a){this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.resizeTo(t),t.insertBefore(this.canvas,t.firstChild),this.drawCover(a)},LightFX.prototype.createCanvasAndResizeTo=function(t,a,i){var e=this.canvas.parentNode,h={width:e.offsetWidth,height:e.offsetHeight};createCanvas(h.width,h.height,t,a,i)},LightFX.prototype.putImageData=function(t,a,i){this.ctx.putImageData(t,a,i),this.imageData=t},LightFX.prototype.cacheImageData=function(){this.cachedImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype._getImageData=function(){return this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.drawImage=function(t,a,i){this.ctx.drawImage(t,a,i),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.draw=function(t){this.ctx.drawImage(t,0,0),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.getDimensions=function(t){return"IMG"===t.nodeName?{width:t.naturalWidth,height:t.naturalHeight}:"CANVAS"===t.nodeName?{width:t.width,height:t.height}:void 0},LightFX.prototype.getAspectRatio=function(t){return dims=this.getDimensions(t),dims.width/dims.height},LightFX.prototype._drawCover=function(t,a){var i,e,h=t.getContext("2d"),n=this.getDimensions(t),s=this.getDimensions(a),c=this.getAspectRatio(t),r=this.getAspectRatio(a);r>c?(e=s.width*(n.height/s.height),i=(n.width-e)/2,h.drawImage(a,i,0,e,n.height)):c>r?(scaledHeight=s.height*(n.width/s.width),i=(n.height-scaledHeight)/2,h.drawImage(a,0,i,n.width,scaledHeight)):h.drawImage(a,0,0,n.width,n.height)},LightFX.prototype.drawCover=function(t){this._drawCover(this.canvas,t),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.createRoundedRect=function(t,a,i,e,h,n){var s={x:a+n,y:i+n},c={x:a+e-n,y:i+n},r={x:a+e-n,y:i+h-n},o={x:a+n,y:i+h-n};t.save(),t.beginPath(),t.moveTo(s.x,i),t.lineTo(c.x,i),t.arc(c.x,c.y,n,1.5*Math.PI,0),t.lineTo(a+e,r.y),t.arc(r.x,r.y,n,0,.5*Math.PI),t.lineTo(o.x,i+h),t.arc(o.x,o.y,n,.5*Math.PI,Math.PI),t.lineTo(a,c.y),t.arc(s.x,s.y,n,Math.PI,1.5*Math.PI),t.closePath()},LightFX.prototype.saturateP=function(t,a,i,e){var h;h=t.data||t;var n,s,c,r,o=.3*(1-a),g=.6*(1-a),v=.1*(1-a);n=void 0===i&&void 0===e?h.length/4:i*e;for(var d=0;n>d;d++){var u=d<<2;s=h[u],c=h[u+1],r=h[u+2],h[u]=(o+a)*s+g*c+v*r,h[u+1]=o*s+(g+a)*c+v*r,h[u+2]=o*s+g*c+(v+a)*r}return t},LightFX.prototype.saturate=function(t,a,i){var e=this.saturateP(this.imageData,t,a,i);this.ctx.putImageData(e,0,0)},LightFX.prototype._contrast=function(t,a){for(var i=t.data,e=259*(a+255)/(255*(259-a)),h=0;h<i.length;h+=4)i[h]=e*(i[h]-128)+128,i[h+1]=e*(i[h+1]-128)+128,i[h+2]=e*(i[h+2]-128)+128;return t},LightFX.prototype.contrast=function(t){var a=this._contrast(this._getImageData(),t);this.ctx.putImageData(a,0,0)},LightFX.prototype.stackblur=function(t){var a=stackBlurCanvasRGB(this.canvas,0,0,this.canvas.width,this.canvas.height,t).id;this.ctx.putImageData(a,0,0)},LightFX.prototype._lightblur=function(t,a){var i,e,h,n=this._createTempCanvas();return n.canvas.width=t.width/8|0,n.canvas.height=t.height/8|0,n.ctx.drawImage(t,0,0,n.canvas.width,n.canvas.height),i=stackBlurCanvasRGB(n.canvas,0,0,n.canvas.width,n.canvas.height,a/8|0).id,e=this._createTempCanvas(),this._resizeTo(e.canvas,n.canvas),e.ctx.putImageData(i,0,0),h=this._createTempCanvas(),this._resizeTo(h.canvas,t),h.ctx.drawImage(e.canvas,0,0,8*e.canvas.width,8*e.canvas.height),h.canvas},LightFX.prototype.lightblur=function(t){var a=this._lightblur(this.canvas,t);this.canvas=a,this.ctx=a.getContext("2d")},LightFX.prototype._lightness=function(t,a){for(var i=t.data,e=0;e<i.length;e+=4)i[e]+=a,i[e+1]+=a,i[e+2]+=a;return t},LightFX.prototype.lightness=function(t){var a=this._lightness(this._getImageData(),t);this.ctx.putImageData(a,0,0)},LightFX.prototype._createBlurStack=function(t,a){var i,e,h,n=this._createTempCanvas(),s=[this._cloneCanvas(this.canvas)];n.canvas.width=t.width/8|0,n.canvas.height=t.height/8|0,n.ctx.drawImage(t,0,0,n.canvas.width,n.canvas.height);for(var c=1;6>c;c++)i=1>(a/8|0)/6*c?1:a/8/6*c,e=stackBlurCanvasRGB(n.canvas,0,0,n.canvas.width,n.canvas.height,i).id,h=this._createTempCanvas(),this._resizeTo(h.canvas,n.canvas),h.ctx.putImageData(e,0,0),s.push(h.canvas),s[c].blurLayerId=c;return s},LightFX.prototype.createBlurStack=function(t){return this._createBlurStack(this.canvas,t)},LightFX.prototype.blurIn=function(t,a){this.blurStack||(this.blurStack=this._createBlurStack(this.canvas,a));var i=this,e=1,h=i.blurStack.length-2,n=t/h|0?t/h|0:10,s=setInterval(function(){e<i.blurStack.length?(i.ctx.drawImage(i.blurStack[e],0,0,8*i.blurStack[e].width+10,8*i.blurStack[e].height|0),e++):clearInterval(s)},n)},LightFX.prototype.blurOut=function(t){this.blurStack||(this.blurStack=this._createBlurStack(this.canvas,radius));var a=this,i=a.blurStack.length-2,e=a.blurStack.length-2,h=t/e|0?t/e|0:10,n=setInterval(function(){i>0?(a.ctx.drawImage(a.blurStack[i],0,0,8*a.blurStack[i].width|0,8*a.blurStack[i].height|0),i--):(a.ctx.drawImage(a.blurStack[i],0,0),clearInterval(n))},h)},window.addEventListener("load",function(){var t=document.getElementById("image"),a=new LightFX(t);a.canvas.addEventListener("mouseenter",function(){a.blurIn(150,140)}),a.canvas.addEventListener("mouseleave",function(){a.blurOut(150,140)});new LightFX(t);document.body.appendChild(a.canvas)});