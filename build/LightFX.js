function LightFX(t){this.canvas=document.createElement("canvas"),this.canvas.id="main",this.ctx=this.canvas.getContext("2d"),this.tempCanvas=void 0,this.imageData=void 0,this.cachedImageData=void 0,this.blurStack=void 0,this._init(t)}LightFX.prototype._init=function(t){void 0!==t&&(this._resizeTo(this.canvas,t),this.ctx.drawImage(t,0,0,this.canvas.width,this.canvas.height))},LightFX.prototype.createCanvas=function(t,a,i,e,h){var s,n,c;void 0!==i&&(s=i.data||i),n=document.createElement("canvas"),c=n.getContext("2d"),n.width=t,n.height=a,c.putImageData(i,e,h),this.canvas=n,this.ctx=c},LightFX.prototype._cloneCanvas=function(t){var a=this._createTempCanvas();return a.canvas.width=t.width,a.canvas.height=t.height,a.ctx.drawImage(t,0,0),a.canvas},LightFX.prototype.replaceCanvas=function(t){this.canvas=t,this.ctx=t.getContext("2d")},LightFX.prototype._createTempCanvas=function(){var t=document.createElement("canvas"),a=t.getContext("2d");return{canvas:t,ctx:a}},LightFX.prototype.resize=function(t,a){this.canvas.width=t,this.canvas.heght=a},LightFX.prototype._resizeTo=function(t,a){t.width=a.offsetWidth||a.naturalWidth||a.width,t.height=a.offsetHeight||a.naturalHeight||a.height},LightFX.prototype.resizeTo=function(t){this._resizeTo(this.canvas,t)},LightFX.prototype.styleAsBackground=function(t,a){this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.resizeTo(t),t.insertBefore(this.canvas,t.firstChild),this.drawCover(a)},LightFX.prototype.createCanvasAndResizeTo=function(t,a,i){var e=this.canvas.parentNode,h={width:e.offsetWidth,height:e.offsetHeight};createCanvas(h.width,h.height,t,a,i)},LightFX.prototype.putImageData=function(t,a,i){this.ctx.putImageData(t,a,i),this.imageData=t},LightFX.prototype.cacheImageData=function(){this.cachedImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype._getImageData=function(){return this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.drawImage=function(t,a,i){this.ctx.drawImage(t,a,i),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.draw=function(t){this.ctx.drawImage(t,0,0),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.getDimensions=function(t){return"IMG"===t.nodeName?{width:t.naturalWidth,height:t.naturalHeight}:"CANVAS"===t.nodeName?{width:t.width,height:t.height}:void 0},LightFX.prototype.getAspectRatio=function(t){return dims=this.getDimensions(t),dims.width/dims.height},LightFX.prototype._drawCover=function(t,a){var i,e,h=t.getContext("2d"),s=this.getDimensions(t),n=this.getDimensions(a),c=this.getAspectRatio(t),r=this.getAspectRatio(a);r>c?(e=n.width*(s.height/n.height),i=(s.width-e)/2,h.drawImage(a,i,0,e,s.height)):c>r?(scaledHeight=n.height*(s.width/n.width),i=(s.height-scaledHeight)/2,h.drawImage(a,0,i,s.width,scaledHeight)):h.drawImage(a,0,0,s.width,s.height)},LightFX.prototype.drawCover=function(t){this._drawCover(this.canvas,t),this.imageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)},LightFX.prototype.createRoundedRect=function(t,a,i,e,h,s){var n={x:a+s,y:i+s},c={x:a+e-s,y:i+s},r={x:a+e-s,y:i+h-s},o={x:a+s,y:i+h-s};t.save(),t.beginPath(),t.moveTo(n.x,i),t.lineTo(c.x,i),t.arc(c.x,c.y,s,1.5*Math.PI,0),t.lineTo(a+e,r.y),t.arc(r.x,r.y,s,0,.5*Math.PI),t.lineTo(o.x,i+h),t.arc(o.x,o.y,s,.5*Math.PI,Math.PI),t.lineTo(a,c.y),t.arc(n.x,n.y,s,Math.PI,1.5*Math.PI),t.closePath()},LightFX.prototype.saturateP=function(t,a,i,e){var h;h=t.data||t;var s,n,c,r,o=.3*(1-a),g=.6*(1-a),v=.1*(1-a);s=void 0===i&&void 0===e?h.length/4:i*e;for(var d=0;s>d;d++){var u=d<<2;n=h[u],c=h[u+1],r=h[u+2],h[u]=(o+a)*n+g*c+v*r,h[u+1]=o*n+(g+a)*c+v*r,h[u+2]=o*n+g*c+(v+a)*r}return t},LightFX.prototype.saturate=function(t,a,i){var e=this.saturateP(this.imageData,t,a,i);this.ctx.putImageData(e,0,0)},LightFX.prototype._contrast=function(t,a){for(var i=t.data,e=259*(a+255)/(255*(259-a)),h=0;h<i.length;h+=4)i[h]=e*(i[h]-128)+128,i[h+1]=e*(i[h+1]-128)+128,i[h+2]=e*(i[h+2]-128)+128;return t},LightFX.prototype.contrast=function(t){var a=this._contrast(this._getImageData(),t);this.ctx.putImageData(a,0,0)},LightFX.prototype.stackblur=function(t){var a=stackBlurCanvasRGB(this.canvas,0,0,this.canvas.width,this.canvas.height,t).id;this.ctx.putImageData(a,0,0)},LightFX.prototype._lightblur=function(t,a){var i,e,h,s=this._createTempCanvas();return s.canvas.width=t.width/8|0,s.canvas.height=t.height/8|0,s.ctx.drawImage(t,0,0,s.canvas.width,s.canvas.height),i=stackBlurCanvasRGB(s.canvas,0,0,s.canvas.width,s.canvas.height,a/8|0).id,e=this._createTempCanvas(),this._resizeTo(e.canvas,s.canvas),e.ctx.putImageData(i,0,0),h=this._createTempCanvas(),this._resizeTo(h.canvas,t),h.ctx.drawImage(e.canvas,0,0,8*e.canvas.width,8*e.canvas.height),h.canvas},LightFX.prototype.lightblur=function(t){var a=this._lightblur(this.canvas,t);this.canvas=a,this.ctx=a.getContext("2d")},LightFX.prototype._lightness=function(t,a){for(var i=t.data,e=0;e<i.length;e+=4)i[e]+=a,i[e+1]+=a,i[e+2]+=a;return t},LightFX.prototype.lightness=function(t){var a=this._lightness(this._getImageData(),t);this.ctx.putImageData(a,0,0)},LightFX.prototype._createBlurStack=function(t,a){var i,e,h,s=this._createTempCanvas(),n=[this._cloneCanvas(this.canvas)];s.canvas.width=t.width/8|0,s.canvas.height=t.height/8|0,s.ctx.drawImage(t,0,0,s.canvas.width,s.canvas.height);for(var c=1;6>c;c++)i=1>(a/8|0)/6*c?1:a/8/6*c,e=stackBlurCanvasRGB(s.canvas,0,0,s.canvas.width,s.canvas.height,i).id,h=this._createTempCanvas(),this._resizeTo(h.canvas,s.canvas),h.ctx.putImageData(e,0,0),n.push(h.canvas),n[c].blurLayerId=c;return n},LightFX.prototype.createBlurStack=function(t){return this._createBlurStack(this.canvas,t)},LightFX.prototype.blurIn=function(t,a){this.blurStack||(this.blurStack=this._createBlurStack(this.canvas,a));var i=this,e=1,h=i.blurStack.length-2,s=t/h|0?t/h|0:10,n=setInterval(function(){e<i.blurStack.length?(i.ctx.drawImage(i.blurStack[e],0,0,8*i.blurStack[e].width+10,8*i.blurStack[e].height|0),e++):clearInterval(n)},s)},LightFX.prototype.blurOut=function(t){this.blurStack||(this.blurStack=this._createBlurStack(this.canvas,radius));var a=this,i=a.blurStack.length-2,e=a.blurStack.length-2,h=t/e|0?t/e|0:10,s=setInterval(function(){i>0?(a.ctx.drawImage(a.blurStack[i],0,0,8*a.blurStack[i].width|0,8*a.blurStack[i].height|0),i--):(a.ctx.drawImage(a.blurStack[i],0,0),clearInterval(s))},h)};